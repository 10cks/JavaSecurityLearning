package com.drunkbaby.springkafkatest.consumer;

import com.drunkbaby.springkafkatest.common.KafkaInfo;
import org.springframework.kafka.annotation.KafkaListener;
import org.springframework.messaging.MessageHeaders;
import org.springframework.messaging.handler.annotation.Headers;
import org.springframework.messaging.handler.annotation.Payload;
import org.springframework.stereotype.Component;

@Component
public class Consumer {
    @KafkaListener(topics = KafkaInfo.TOPIC_WELCOME)
    public String consumer2(@Payload String message, @Headers MessageHeaders headers) {
        System.out.println("消费者(注解方式)：收到消息==> ");
        System.out.println("  message：" + message);
        System.out.println("  headers:");
        headers.keySet().forEach(key -> System.out.println("    " + key + ":" + headers.get(key)));
        return "success";
    }

    // //下边这样写也可以
    // @KafkaListener(topics = KafkaInfo.TOPIC_WELCOME)
    // public String consumer1(ConsumerRecord<String, String> consumerRecord) {
    //     System.out.println("消费者(ConsumerRecord方式)：收到消息==> " + "value类型：" + consumerRecord.value().getClass().getName()
    //             + "; 数据：" + consumerRecord.value());
    //     return "success";
    // }
}
